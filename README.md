# SpringFinalProject
![main](https://user-images.githubusercontent.com/87956011/149283391-c0987216-5f58-4e12-bb04-c28690973f2a.JPG)

# 서비스 목적

사람들이 갖고 있는 다양한 아이디어들을 생각 속 에만 머무르는 것이 아니라 실제로 상품화 해서 실생활에 적용 될 수 있도록 후원해주는 크라우드 펀딩 사이트를 구현 했습니다.

기능요약
1. 대부분의 서비스는 회원가입을 통해 가능하고 회원가입시 비밀번호를 암호화 해서 DB에 저장합니다.
2. 회원가입을 하지 않아도 등록된 프로젝트 게시물은 확인이 가능하지만 댓글이나 채팅 문의 같은 기능들은 사용이 불가능합니다.
3. 회원가입을 통해서 후원 받고 싶은 게시물을 등록 할수 있고 등록시에는 관리자 페이지에서 심사를 거쳐서 최종적으로 게시물이 등록 됩니다.
4. 등록된 게시물에는 댓글을 등록하고 게시물 작성자에게 문의가 가능하며 댓글을 작성한 회원의 프로필을 클릭해서 이동하면 해당 회원의 프로필을 확인할 수 있고 채팅또한 가능합니다.
5. 등록된 게시물을 후원하면 카카오 결제 API를 사용해서 바로 결제되는 것이 아니라 정기 결제가 가능하도록 구현했습니다


# 프로젝트 담당 역할

- 채팅 api

1. 사용하기 쉬운 api여도 조금이라도 API경험을 위해 사용


- 채팅

1. 댓글이나 프로젝트 작성자의 프로필을 클릭하면 프로필 페이지로 이동되고 본인의 프로필 페이지가 아니면 채팅 버튼이 활성화되어서 채팅이 가능하도록 구현

2. 메시지를 읽었는지를 확인할 수 있도록 구현

3. 메시지를 읽지 않고 읽음 처리가 가능하도록 구현

4. 채팅방을 나가기 가능 단 한 명이 나갔다고 상대방 또한 나가지는 구조가 아닌 나가기를 누르지 않은 상대방은 메시지를 보낼 수는 없지만 나가기를 누르기 전까지 내역을 확인 가능하도록 구현

5. 웹소켓을 활용하지 않았기 때문에 실시간 채팅을 구현하는데 어려움 이 있었지만 리로드 기능을 추가해서 어느 정도 실시간 채팅이 가능하도록 구현


- 댓글

1. 로그인 후에만 작성할 수 있도록 구현

2. 댓글을 작성, 출력, 수정, 삭제가 되도록 구현

3. 삭제 기능은 대 댓글일 경우와 댓글에 때 댓글이 없을 경우는 단순하게 삭제되지만 댓글에 때 댓글이 달려있을 경우 DB에 값을 주어서 출력 시 삭제되었다는 문구가 보이게 출력하고 달려있는 때 댓글이 모두 삭제될 경우같이 삭제 되도록 구현

4. 댓글과 해당 댓글에 달린 대 댓글 또한 댓글 제일 상단에 출력되도록 하는 고정 기능 구현 단 고정 기능은 해당 글 작성자만 가능

5. 해당 글 작성자일 경우 창작자라는 표시가 출력

6. 댓글에 처음 달린 답글일 경우와 본인의 글에 답글을 작성할 경우를 제외하고 다른 사람 때 댓글에 답글을 달면 @표시로 해당 작성자의 아이디를 표시하고 이렇게 표시된 부분을 클릭하면 해당 글이 삭제되어 있지 않다면 어떤 내용이었는지 출력 가능


- 리스트 랜덤 출력 페이지

1. 프로젝트를 후원해서 결제를 하면 나타나는 축하 페이지와 페이 지안에 랜덤으로 4개의 프로젝트를 추천


게시판에서 글을 선택한 카테고리에 맞게 출력하기와 검색 기능

1. 이 부분을 담당하던 팀원이 취업으로 마무리할 수 없게 되어서 급하게 맡아서 기존 팀원이 작성했던 코드에 맞게 sql, dto, mapper, service, controller 부분을 설계

2. 카테 고를 선택하거나 검색을 했을 경우 해당 조건에 맞게 글들이 출력되도록 구현

- 프로젝트 발표</br>
프로젝트 팀원소개, 사이트소개, 개발환경, 핵심기능 발표 담당

- 프로젝트 배포</br>
1. AWS EC2의 RDP원격 컴퓨터에 톰캣과 java를 설치하였고 프로젝트를 ROOT.war 파일로 export 해서 배포</br>
2. AWS의 RDS에 MYSQL을 사용

# 담당기능 발표
- 채팅
https://user-images.githubusercontent.com/87956011/149280883-6e3fb49a-7aaa-4e8e-b23c-835b4cff0f12.mp4

- 댓글
https://user-images.githubusercontent.com/87956011/149280971-8d3f0ffb-8683-4872-ac72-d15cd08bc84c.mp4


# 개발환경
![erd](https://user-images.githubusercontent.com/87956011/149282806-2de2ec02-6cbd-4327-8fe1-16798acc9328.jpg)
팀프로젝트이기 때문에 팀원들과의 협업이 중요한 핵심요소라고 생각했습니다. 그래서 저희팀은 팀원들이 프로젝트 진행중에 필요한 파일이나 회의내용등을 Git 과 Notion을 사용해서 빠르게 공유함으로써 이야기했던 내용들을 반복할 필요가 없었습니다 그래서 개발할 수 있는 시간을 극대화해서 프로젝트를 효율적으로 진행했습니다.

![erd (2)](https://user-images.githubusercontent.com/87956011/149282909-78e44c22-9907-4641-86cc-cf84841d4023.jpg)

member table의 id를 comment, project, chat, message 테이블에서 외래키로 사용였습니다.
그 다음 제약조건에 on delete cascade, on update cascade를 주어서 해당 id회원이 탈퇴하거나
정보를 수정할때 외래키로 사용하고 있는 테이블의 정보도 같이 update되거나 삭제되도록
DB를 설계했습니다.


# 프로젝트 종료 후 유지보수 Update
# - Xss attack protecting <br/>
프로젝트 종료 후 담당했던 부분들에 대해서 점검 도중 유튜브를 통해서 본 영상 중에 log4j 취약점이 생각났습니다. <br/>
그래서 저 또한 담당해서 구현한 기능에 보안관련 문제들이 없는지 궁금했습니다.<br/>
기본적으로 특수문자나 태그들이 문자그대로 출력되는지 확인을 했습니다. 그 결과 태그를 작성해서 db에 저장하면 <br/>
출력시 태그가 문자가아닌 태그로 인식되는 심각한 문제를 발견했습니다.<br/>
문제를 해결 하기위해서 관련 내용을 검색했습니다. 그리고 다음과 같은 시도를 했습니다.<br/>
1. naver 에서 개발한 lucy-xss-servlet-filter를 적용 시켰습니다. 제가 구현한 기능들은 json을 이용한것이 대부분이였는데요 안타깝게도
lucy는 json 까지 방어해주지 못했습니다.<br/>
2. json을 xss로부터 보호해 줄 수 있는 방법 들을 검색했습니다. 여러 방법들을 모두 적용해 보면서 방어해 주는지를 체크했습니다.
CharacterEscapes를 상속받아 HTMLCharacterEscapes를 구현하는방법을 발견하고 적용시켜서 문제를 해결했습니다.
<br/>
디테일한 부분을 충분히 테스트하고 항상 다양한 관점에서 생각해 보는 것이 중요함을 깨닫게 해주는 문제였습니다.

